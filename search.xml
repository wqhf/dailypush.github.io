<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>R中常见的小问题</title>
      <link href="/post/R%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E5%B0%8F%E9%97%AE%E9%A2%98/"/>
      <url>/post/R%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E5%B0%8F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><p>来源：<a href="http://blog.genesino.com/collections/R_tips/" target="_blank" rel="noopener">http://blog.genesino.com/collections/R_tips/</a></p><h3 id="记录无法归类的小问题及解决方法"><a href="#记录无法归类的小问题及解决方法" class="headerlink" title="记录无法归类的小问题及解决方法"></a>记录无法归类的小问题及解决方法</h3><ol><li>查看R函数代码</li></ol><ul><li><p>如果是R的内部函数，直接输入函数名字，即可查看函数的代码</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt; colMeans</span><br><span class="line"><span class="keyword">function</span> (x, na.rm = <span class="literal">FALSE</span>, dims = <span class="number">1L</span>) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (is.data.frame(x)) </span><br><span class="line">        x &lt;- as.matrix(x)</span><br><span class="line">    <span class="keyword">if</span> (!is.array(x) || length(dn &lt;- dim(x)) &lt; <span class="number">2L</span>) </span><br><span class="line">        <span class="keyword">stop</span>(<span class="string">"'x' must be an array of at least two dimensions"</span>)</span><br><span class="line">    <span class="keyword">if</span> (dims &lt; <span class="number">1L</span> || dims &gt; length(dn) - <span class="number">1L</span>) </span><br><span class="line">        <span class="keyword">stop</span>(<span class="string">"invalid 'dims'"</span>)</span><br><span class="line">    n &lt;- prod(dn[id &lt;- seq_len(dims)])</span><br><span class="line">    dn &lt;- dn[-id]</span><br><span class="line">    z &lt;- <span class="keyword">if</span> (is.complex(x)) </span><br><span class="line">        .Internal(colMeans(Re(x), n, prod(dn), na.rm)) + (<span class="number">0</span>+<span class="number">1i</span>) * </span><br><span class="line">            .Internal(colMeans(Im(x), n, prod(dn), na.rm))</span><br><span class="line">    <span class="keyword">else</span> .Internal(colMeans(x, n, prod(dn), na.rm))</span><br><span class="line">    <span class="keyword">if</span> (length(dn) &gt; <span class="number">1L</span>) &#123;</span><br><span class="line">        dim(z) &lt;- dn</span><br><span class="line">        dimnames(z) &lt;- dimnames(x)[-id]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> names(z) &lt;- dimnames(x)[[dims + <span class="number">1L</span>]]</span><br><span class="line">    z</span><br><span class="line">&#125;</span><br><span class="line">&lt;bytecode: <span class="number">0x2122250</span>&gt;</span><br><span class="line">&lt;environment: namespace:base&gt;</span><br></pre></td></tr></table></figure></li></ul><a id="more"></a><ul><li><p>如果是S4函数，则需要使用getMethod(function_name, package_name)</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; showMethods(<span class="string">'MeanVarPlot'</span>)</span><br><span class="line">Function: MeanVarPlot (package Seurat)</span><br><span class="line">object=<span class="string">"seurat"</span></span><br><span class="line">    </span><br><span class="line">&gt; getMethod(<span class="string">"MeanVarPlot"</span>, <span class="string">"seurat"</span>)</span><br><span class="line">Method Definition:</span><br><span class="line">    </span><br><span class="line"><span class="keyword">function</span> (object, fxn.x = expMean, fxn.y = logVarDivMean, do.plot = <span class="literal">TRUE</span>, </span><br><span class="line">       set.var.genes = <span class="literal">TRUE</span>, do.text = <span class="literal">TRUE</span>, x.low.cutoff = <span class="number">0.1</span>, </span><br><span class="line">       x.high.cutoff = <span class="number">8</span>, y.cutoff = <span class="number">1</span>, y.high.cutoff = <span class="literal">Inf</span>, cex.use = <span class="number">0.5</span>, </span><br><span class="line">       cex.text.use = <span class="number">0.5</span>, do.spike = <span class="literal">FALSE</span>, pch.use = <span class="number">16</span>, col.use = <span class="string">"black"</span>, </span><br><span class="line">       spike.col.use = <span class="string">"red"</span>, plot.both = <span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure></li></ul><ol start="2"><li><p>sapply usage</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; a &lt;- as.data.frame(matrix(rnorm(<span class="number">30</span>), ncol=<span class="number">3</span>))</span><br><span class="line">&gt; a</span><br><span class="line">           V1           V2            V3</span><br><span class="line"><span class="number">1</span>   <span class="number">1.1678261</span>  <span class="number">0.535765512</span> -<span class="number">0.0002789383</span></span><br><span class="line"><span class="number">2</span>   <span class="number">1.4408018</span>  <span class="number">0.006156163</span> -<span class="number">0.8926204461</span></span><br><span class="line"><span class="number">3</span>  -<span class="number">0.7577270</span> -<span class="number">0.252982299</span>  <span class="number">0.7633047153</span></span><br><span class="line"><span class="number">4</span>  -<span class="number">0.6555118</span> -<span class="number">0.940734927</span>  <span class="number">0.5586641498</span></span><br><span class="line"><span class="number">5</span>   <span class="number">1.6814423</span>  <span class="number">0.536600480</span>  <span class="number">0.0965808879</span></span><br><span class="line"><span class="number">6</span>  -<span class="number">1.5529560</span> -<span class="number">1.491656309</span> -<span class="number">0.1404898216</span></span><br><span class="line"><span class="number">7</span>  -<span class="number">0.2791699</span> -<span class="number">0.405854634</span> -<span class="number">0.6891447979</span></span><br><span class="line"><span class="number">8</span>  -<span class="number">0.5111633</span>  <span class="number">1.071639283</span>  <span class="number">0.4492834514</span></span><br><span class="line"><span class="number">9</span>  -<span class="number">0.0406343</span>  <span class="number">0.243810629</span>  <span class="number">0.9092924868</span></span><br><span class="line"><span class="number">10</span> -<span class="number">1.4827207</span> -<span class="number">0.333623245</span> -<span class="number">0.2155860373</span></span><br><span class="line">&gt; a$Group = c(rep(<span class="string">'A'</span>,<span class="number">5</span>), rep(<span class="string">'B'</span>,<span class="number">5</span>))</span><br><span class="line">&gt; a</span><br><span class="line">           V1           V2            V3 Group</span><br><span class="line"><span class="number">1</span>   <span class="number">1.1678261</span>  <span class="number">0.535765512</span> -<span class="number">0.0002789383</span>     A</span><br><span class="line"><span class="number">2</span>   <span class="number">1.4408018</span>  <span class="number">0.006156163</span> -<span class="number">0.8926204461</span>     A</span><br><span class="line"><span class="number">3</span>  -<span class="number">0.7577270</span> -<span class="number">0.252982299</span>  <span class="number">0.7633047153</span>     A</span><br><span class="line"><span class="number">4</span>  -<span class="number">0.6555118</span> -<span class="number">0.940734927</span>  <span class="number">0.5586641498</span>     A</span><br><span class="line"><span class="number">5</span>   <span class="number">1.6814423</span>  <span class="number">0.536600480</span>  <span class="number">0.0965808879</span>     A</span><br><span class="line"><span class="number">6</span>  -<span class="number">1.5529560</span> -<span class="number">1.491656309</span> -<span class="number">0.1404898216</span>     B</span><br><span class="line"><span class="number">7</span>  -<span class="number">0.2791699</span> -<span class="number">0.405854634</span> -<span class="number">0.6891447979</span>     B</span><br><span class="line"><span class="number">8</span>  -<span class="number">0.5111633</span>  <span class="number">1.071639283</span>  <span class="number">0.4492834514</span>     B</span><br><span class="line"><span class="number">9</span>  -<span class="number">0.0406343</span>  <span class="number">0.243810629</span>  <span class="number">0.9092924868</span>     B</span><br><span class="line"><span class="number">10</span> -<span class="number">1.4827207</span> -<span class="number">0.333623245</span> -<span class="number">0.2155860373</span>     B</span><br><span class="line">&gt; my_function &lt;- <span class="keyword">function</span>(x) &#123; </span><br><span class="line">+     A &lt;- x[a$Group==<span class="string">"A"</span>]</span><br><span class="line">+     B &lt;- x[a$Group==<span class="string">"B"</span>]</span><br><span class="line">+     t.test(A, B)$p.value</span><br><span class="line">+ &#125;</span><br><span class="line"></span><br><span class="line">&gt; sapply(X=a[,!(names(a) %<span class="keyword">in</span>% c(<span class="string">"Group"</span>))], FUN=my_function, simplify = <span class="literal">T</span>)</span><br><span class="line">       V1        V2        V3 </span><br><span class="line"><span class="number">0.0675659</span> <span class="number">0.7597376</span> <span class="number">0.9180267</span> </span><br><span class="line">&gt; t.test(a$V1[<span class="number">1</span>:<span class="number">5</span>],a$V1[<span class="number">6</span>:<span class="number">10</span>])$p.value</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.0675659</span></span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>Automatically install packages if not exist</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">usePackage &lt;- <span class="keyword">function</span>(p) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!is.element(p, installed.packages()[,<span class="number">1</span>]))</span><br><span class="line">        install.packages(p, dep = <span class="literal">TRUE</span>)</span><br><span class="line">        <span class="keyword">require</span>(p, character.only = <span class="literal">TRUE</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>Sometimes when you found the lines reading by <code>read.table</code> smaller than real line number, please check it you have <code>&quot;&quot;</code> or <code>&#39;&#39;</code> in your file.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Always set no quote</span></span><br><span class="line">a &lt;- read.table(file, sep=<span class="string">"\t"</span>,  header=<span class="literal">T</span>, row.names=<span class="number">1</span>, quote=<span class="string">""</span>)</span><br></pre></td></tr></table></figure></li></ol><ol start="5"><li><p>Read in data from string rather than files</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">"a\tb\tc</span></span><br><span class="line"><span class="string">d\te\tf</span></span><br><span class="line"><span class="string">g\th\ti"</span></span><br><span class="line">   </span><br><span class="line">data  &lt;- read.table(text=string, sep=<span class="string">"\t"</span>)</span><br></pre></td></tr></table></figure></li><li><p>使用Aggregate进行分组计算</p><p>Aggregate by one column of dataframe.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; ID &lt;- c(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>)</span><br><span class="line">&gt; A &lt;- c(<span class="number">1</span>:<span class="number">7</span>)</span><br><span class="line">&gt; B &lt;- c(<span class="number">3</span>:<span class="number">9</span>)</span><br><span class="line">&gt; C &lt;- c(<span class="number">9</span>:<span class="number">3</span>)</span><br><span class="line">&gt; test &lt;- data.frame(ID, A, B, C)</span><br><span class="line">&gt; test</span><br><span class="line">  ID A B C</span><br><span class="line"><span class="number">1</span>  a <span class="number">1</span> <span class="number">3</span> <span class="number">9</span></span><br><span class="line"><span class="number">2</span>  b <span class="number">2</span> <span class="number">4</span> <span class="number">8</span></span><br><span class="line"><span class="number">3</span>  c <span class="number">3</span> <span class="number">5</span> <span class="number">7</span></span><br><span class="line"><span class="number">4</span>  b <span class="number">4</span> <span class="number">6</span> <span class="number">6</span></span><br><span class="line"><span class="number">5</span>  c <span class="number">5</span> <span class="number">7</span> <span class="number">5</span></span><br><span class="line"><span class="number">6</span>  d <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line"><span class="number">7</span>  e <span class="number">7</span> <span class="number">9</span> <span class="number">3</span></span><br><span class="line">&gt; a = aggregate(test[<span class="number">2</span>:<span class="number">4</span>], by=test[<span class="number">1</span>], FUN=mean)</span><br><span class="line">&gt; a</span><br><span class="line">  ID A B C</span><br><span class="line"><span class="number">1</span>  a <span class="number">1</span> <span class="number">3</span> <span class="number">9</span></span><br><span class="line"><span class="number">2</span>  b <span class="number">3</span> <span class="number">5</span> <span class="number">7</span></span><br><span class="line"><span class="number">3</span>  c <span class="number">4</span> <span class="number">6</span> <span class="number">6</span></span><br><span class="line"><span class="number">4</span>  d <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line"><span class="number">5</span>  e <span class="number">7</span> <span class="number">9</span> <span class="number">3</span></span><br></pre></td></tr></table></figure><p>Aggregate by an external variable</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&gt; a &lt;- <span class="string">"ID;Grp</span></span><br><span class="line"><span class="string">A.1;A</span></span><br><span class="line"><span class="string">A.2;A</span></span><br><span class="line"><span class="string">A.3;A</span></span><br><span class="line"><span class="string">B.3;B</span></span><br><span class="line"><span class="string">B.4;B</span></span><br><span class="line"><span class="string">C.1;C</span></span><br><span class="line"><span class="string">B.1;B</span></span><br><span class="line"><span class="string">B.2;B</span></span><br><span class="line"><span class="string">C.2;C"</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; b &lt;- <span class="string">"ID;A.1;A.2;A.3;B.1;B.2;B.3;B.4;C.1;C.2</span></span><br><span class="line"><span class="string">a;1;2;3;8;2;3;4;4;2</span></span><br><span class="line"><span class="string">b;1;3;3;1;3;3;4;1;2</span></span><br><span class="line"><span class="string">c;2;4;3;1;5;3;6;2;2"</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; sampFile &lt;- read.table(text=a, sep=<span class="string">';'</span>, row.names=<span class="number">1</span>, header=<span class="literal">T</span>)</span><br><span class="line">&gt; </span><br><span class="line">&gt; mat &lt;- read.table(text=b, sep=<span class="string">';'</span>, header=<span class="literal">T</span>,row.names=<span class="number">1</span>)</span><br><span class="line">&gt; mat_t &lt;- t(mat)</span><br><span class="line">&gt; mat_t</span><br><span class="line">    a b c</span><br><span class="line">A.1 <span class="number">1</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line">A.2 <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">A.3 <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line">B.1 <span class="number">8</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">B.2 <span class="number">2</span> <span class="number">3</span> <span class="number">5</span></span><br><span class="line">B.3 <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line">B.4 <span class="number">4</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line">C.1 <span class="number">4</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line">C.2 <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; Grp &lt;- sampFile[match(rownames(mat_t), rownames(sampFile)),<span class="number">1</span>]</span><br><span class="line">&gt;</span><br><span class="line">&gt; <span class="comment">#The variable given to `by` in `aggregate` must be a list </span></span><br><span class="line">&gt; mat_mean &lt;- aggregate(mat_t, by=list(Grp=Grp), FUN=mean)</span><br><span class="line">&gt; </span><br><span class="line">&gt; mat_mean_grp &lt;- mat_mean$Grp</span><br><span class="line">&gt; </span><br><span class="line">&gt; mat_mean_final &lt;- do.call(rbind, mat_mean)[-<span class="number">1</span>,]</span><br><span class="line">&gt; </span><br><span class="line">&gt; colnames(mat_mean_final) &lt;- mat_mean_grp</span><br><span class="line">&gt; </span><br><span class="line">&gt; mat_mean_final</span><br><span class="line">         A    B   C</span><br><span class="line">a <span class="number">2.000000</span> <span class="number">4.25</span> <span class="number">3.0</span></span><br><span class="line">b <span class="number">2.333333</span> <span class="number">2.75</span> <span class="number">1.5</span></span><br><span class="line">c <span class="number">3.000000</span> <span class="number">3.75</span> <span class="number">2.0</span></span><br></pre></td></tr></table></figure></li><li><p>条件填充数据表</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&gt; A &lt;- c(<span class="number">1</span>:<span class="number">9</span>)</span><br><span class="line">&gt; B &lt;- c(<span class="number">11</span>:<span class="number">5</span>,<span class="number">13</span>,<span class="number">14</span>)</span><br><span class="line">&gt; C &lt;- c(<span class="number">9</span>:<span class="number">1</span>)</span><br><span class="line">&gt; test &lt;- data.frame(A, B, C)</span><br><span class="line">&gt; test</span><br><span class="line">&gt;      A  B C</span><br><span class="line">&gt;    <span class="number">1</span> <span class="number">1</span> <span class="number">11</span> <span class="number">9</span></span><br><span class="line">&gt;    <span class="number">2</span> <span class="number">2</span> <span class="number">10</span> <span class="number">8</span></span><br><span class="line">&gt;    <span class="number">3</span> <span class="number">3</span>  <span class="number">9</span> <span class="number">7</span></span><br><span class="line">&gt;    <span class="number">4</span> <span class="number">4</span>  <span class="number">8</span> <span class="number">6</span></span><br><span class="line">&gt;    <span class="number">5</span> <span class="number">5</span>  <span class="number">7</span> <span class="number">5</span></span><br><span class="line">&gt;    <span class="number">6</span> <span class="number">6</span>  <span class="number">6</span> <span class="number">4</span></span><br><span class="line">&gt;    <span class="number">7</span> <span class="number">7</span>  <span class="number">5</span> <span class="number">3</span></span><br><span class="line">&gt;    <span class="number">8</span> <span class="number">8</span> <span class="number">13</span> <span class="number">2</span></span><br><span class="line">&gt;    <span class="number">9</span> <span class="number">9</span> <span class="number">14</span> <span class="number">1</span></span><br><span class="line">&gt; lod_generate3 &lt;- <span class="keyword">function</span>(x)&#123;</span><br><span class="line">&gt;    +   <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">2</span>:length(x))&#123;</span><br><span class="line">&gt;    +     <span class="keyword">if</span>(x[i]&lt;x[<span class="number">1</span>])</span><br><span class="line">&gt;    +       x[i] &lt;- round(runif(<span class="number">1</span>,min=<span class="number">0</span>,max=x[<span class="number">1</span>]))</span><br><span class="line">&gt;    +   &#125;</span><br><span class="line">&gt;    +   x</span><br><span class="line">&gt;    + &#125;</span><br><span class="line">&gt; apply(test, <span class="number">2</span>, lod_generate3)</span><br><span class="line">&gt;          A  B C</span><br><span class="line">&gt;</span><br><span class="line">&gt;     [<span class="number">1</span>,] <span class="number">1</span> <span class="number">11</span> <span class="number">9</span></span><br><span class="line">&gt;     [<span class="number">2</span>,] <span class="number">2</span>  <span class="number">9</span> <span class="number">6</span></span><br><span class="line">&gt;     [<span class="number">3</span>,] <span class="number">3</span>  <span class="number">9</span> <span class="number">7</span></span><br><span class="line">&gt;     [<span class="number">4</span>,] <span class="number">4</span>  <span class="number">2</span> <span class="number">8</span></span><br><span class="line">&gt;     [<span class="number">5</span>,] <span class="number">5</span>  <span class="number">9</span> <span class="number">6</span></span><br><span class="line">&gt;     [<span class="number">6</span>,] <span class="number">6</span> <span class="number">10</span> <span class="number">2</span></span><br><span class="line">&gt;     [<span class="number">7</span>,] <span class="number">7</span>  <span class="number">7</span> <span class="number">7</span></span><br><span class="line">&gt;     [<span class="number">8</span>,] <span class="number">8</span> <span class="number">13</span> <span class="number">2</span></span><br><span class="line">&gt;     [<span class="number">9</span>,] <span class="number">9</span> <span class="number">14</span> <span class="number">5</span></span><br></pre></td></tr></table></figure></li><li><p>每一列的数除以该列的总和</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&gt; a &lt;- data.frame(<span class="string">'a'</span>=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),<span class="string">'b'</span>=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),<span class="string">'d'</span>=<span class="number">2</span>:<span class="number">5</span>)</span><br><span class="line">&gt; a</span><br><span class="line">  a b d</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line">&gt; colSums(a)</span><br><span class="line"> a  b  d </span><br><span class="line"><span class="number">10</span> <span class="number">10</span> <span class="number">14</span> </span><br><span class="line">&gt; a/colSums(a) <span class="comment">#Wrong</span></span><br><span class="line">          a         b         d</span><br><span class="line"><span class="number">1</span> <span class="number">0.1000000</span> <span class="number">0.1000000</span> <span class="number">0.1428571</span></span><br><span class="line"><span class="number">2</span> <span class="number">0.2000000</span> <span class="number">0.1428571</span> <span class="number">0.3000000</span></span><br><span class="line"><span class="number">3</span> <span class="number">0.2142857</span> <span class="number">0.3000000</span> <span class="number">0.4000000</span></span><br><span class="line"><span class="number">4</span> <span class="number">0.4000000</span> <span class="number">0.4000000</span> <span class="number">0.3571429</span></span><br><span class="line">&gt; t(a)/colSums(a) <span class="comment">#Half-right</span></span><br><span class="line">       [,<span class="number">1</span>]      [,<span class="number">2</span>]      [,<span class="number">3</span>]      [,<span class="number">4</span>]</span><br><span class="line">a <span class="number">0.1000000</span> <span class="number">0.2000000</span> <span class="number">0.3000000</span> <span class="number">0.4000000</span></span><br><span class="line">b <span class="number">0.1000000</span> <span class="number">0.2000000</span> <span class="number">0.3000000</span> <span class="number">0.4000000</span></span><br><span class="line">d <span class="number">0.1428571</span> <span class="number">0.2142857</span> <span class="number">0.2857143</span> <span class="number">0.3571429</span></span><br><span class="line">&gt; t(t(a)/colSums(a)) <span class="comment">#Right</span></span><br><span class="line">       a   b         d</span><br><span class="line">[<span class="number">1</span>,] <span class="number">0.1</span> <span class="number">0.1</span> <span class="number">0.1428571</span></span><br><span class="line">[<span class="number">2</span>,] <span class="number">0.2</span> <span class="number">0.2</span> <span class="number">0.2142857</span></span><br><span class="line">[<span class="number">3</span>,] <span class="number">0.3</span> <span class="number">0.3</span> <span class="number">0.2857143</span></span><br><span class="line">[<span class="number">4</span>,] <span class="number">0.4</span> <span class="number">0.4</span> <span class="number">0.3571429</span></span><br></pre></td></tr></table></figure></li><li><p>取出共同的列</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&gt; a &lt;- data.frame(<span class="string">'a'</span>=<span class="number">1</span>:<span class="number">5</span>,<span class="string">'b'</span>=<span class="number">2</span>:<span class="number">6</span>,<span class="string">'c'</span>=round(runif(<span class="number">5</span>,min=<span class="number">0</span>, max=<span class="number">2</span>)),<span class="string">'d'</span>=sample(<span class="number">1</span>:<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line">&gt; a</span><br><span class="line">  a b c d</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">6</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">2</span> <span class="number">8</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">4</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">5</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">5</span> <span class="number">5</span> <span class="number">6</span> <span class="number">2</span> <span class="number">4</span></span><br><span class="line">&gt; b = data.frame(<span class="string">'b'</span>=round(rnorm(<span class="number">5</span>, mean=<span class="number">50</span>, sd=<span class="number">10</span>)),<span class="string">'e'</span>=rep(<span class="number">1</span>,<span class="number">5</span>),<span class="string">'d'</span>=round(runif(<span class="number">5</span>,min=<span class="number">0</span>, max=<span class="number">10</span>)),<span class="string">'c'</span>=sample(<span class="number">1</span>:<span class="number">10</span>,<span class="number">5</span>, replace=<span class="literal">T</span>))</span><br><span class="line">&gt; b</span><br><span class="line">   b e d c</span><br><span class="line"><span class="number">1</span> <span class="number">33</span> <span class="number">1</span> <span class="number">5</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">62</span> <span class="number">1</span> <span class="number">8</span> <span class="number">6</span></span><br><span class="line"><span class="number">3</span> <span class="number">26</span> <span class="number">1</span> <span class="number">8</span> <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="number">63</span> <span class="number">1</span> <span class="number">8</span> <span class="number">6</span></span><br><span class="line"><span class="number">5</span> <span class="number">43</span> <span class="number">1</span> <span class="number">9</span> <span class="number">4</span></span><br><span class="line">&gt; ?match(x, y)</span><br><span class="line"><span class="comment"># Select elements existed in x for each in y and ordered as in x</span></span><br><span class="line"><span class="comment"># Remove elements only existed in y</span></span><br><span class="line">&gt; b[,na.omit(match(colnames(a),colnames(b)))]</span><br><span class="line">   b c d</span><br><span class="line"><span class="number">1</span> <span class="number">33</span> <span class="number">7</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">62</span> <span class="number">6</span> <span class="number">8</span></span><br><span class="line"><span class="number">3</span> <span class="number">26</span> <span class="number">1</span> <span class="number">8</span></span><br><span class="line"><span class="number">4</span> <span class="number">63</span> <span class="number">6</span> <span class="number">8</span></span><br><span class="line"><span class="number">5</span> <span class="number">43</span> <span class="number">4</span> <span class="number">9</span></span><br></pre></td></tr></table></figure></li><li><p>pairwise.t.test for a matrix</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&gt; data = data.frame(Group=c(rep(<span class="string">'a'</span>,<span class="number">20</span>),rep(<span class="string">'b'</span>,<span class="number">20</span>),rep(<span class="string">'c'</span>,<span class="number">20</span>)), A=runif(<span class="number">60</span>, min=<span class="number">0</span>, max=<span class="number">60</span>), B=c(sample(<span class="number">1</span>:<span class="number">10</span>,<span class="number">20</span>,replace=<span class="literal">T</span>), sample(<span class="number">20</span>:<span class="number">30</span>,<span class="number">20</span>,replace=<span class="literal">T</span>), c(sample(<span class="number">1</span>:<span class="number">30</span>,<span class="number">20</span>, replace=<span class="literal">T</span>))))</span><br><span class="line">&gt; data</span><br><span class="line">   Group          A  B</span><br><span class="line"><span class="number">1</span>      a  <span class="number">8.3522445</span>  <span class="number">6</span></span><br><span class="line"><span class="number">2</span>      a <span class="number">22.9813777</span>  <span class="number">4</span></span><br><span class="line"><span class="number">3</span>      a <span class="number">11.5574241</span>  <span class="number">8</span></span><br><span class="line"><span class="number">4</span>      a <span class="number">57.5316085</span>  <span class="number">6</span></span><br><span class="line"><span class="number">5</span>      a <span class="number">20.2775717</span>  <span class="number">2</span></span><br><span class="line">.      . .           .</span><br><span class="line">.      . .           .</span><br><span class="line"><span class="number">21</span>     b <span class="number">36.8333789</span> <span class="number">25</span></span><br><span class="line"><span class="number">22</span>     b <span class="number">23.5413342</span> <span class="number">24</span></span><br><span class="line"><span class="number">23</span>     b <span class="number">41.6235628</span> <span class="number">26</span></span><br><span class="line"><span class="number">24</span>     b <span class="number">27.5968927</span> <span class="number">25</span></span><br><span class="line"><span class="number">25</span>     b <span class="number">48.6045175</span> <span class="number">20</span></span><br><span class="line">.      . .           .</span><br><span class="line">.      . .           .</span><br><span class="line"><span class="number">58</span>     c <span class="number">51.0684425</span> <span class="number">30</span></span><br><span class="line"><span class="number">59</span>     c  <span class="number">4.0294234</span> <span class="number">27</span></span><br><span class="line"><span class="number">60</span>     c <span class="number">22.6168908</span> <span class="number">27</span></span><br><span class="line">&gt; my_function &lt;- <span class="keyword">function</span>(x) &#123;</span><br><span class="line">+     pvalue_m = pairwise.t.test(x, data$Group, pool.sd = <span class="literal">F</span>)$p.value</span><br><span class="line">+     pvalue_m &lt;- as.data.frame(pvalue_m)</span><br><span class="line">+     pvalue_m$id &lt;- rownames(pvalue_m)</span><br><span class="line">+     pvalue_m &lt;- melt(pvalue_m, id.vars=c(<span class="string">'id'</span>))</span><br><span class="line">+     name_combine = paste(pvalue_m$id, pvalue_m$variable,sep=<span class="string">'.vs.'</span>)</span><br><span class="line">+     pvalue_m &lt;- as.data.frame(pvalue_m$value)</span><br><span class="line">+     rownames(pvalue_m) &lt;- name_combine</span><br><span class="line">+     pvalue_m</span><br><span class="line">+     <span class="comment">#colnames(pvalue_m)[colnames(pvalue_m)=="value"] = name_col</span></span><br><span class="line">+     <span class="comment">#x</span></span><br><span class="line">+ &#125;</span><br><span class="line">&gt; p.value &lt;- apply(X=data[,-<span class="number">1</span>], <span class="number">2</span>,FUN=my_function)</span><br><span class="line">&gt; p.value &lt;- do.call(cbind, p.value)</span><br><span class="line">&gt; colnames(p.value) &lt;- colnames(data[,-<span class="number">1</span>])</span><br><span class="line">&gt; t(p.value)</span><br><span class="line">        b.vs.a      c.vs.a b.vs.b       c.vs.b</span><br><span class="line">A <span class="number">8.670387e-01</span> <span class="number">0.454526764</span>     <span class="literal">NA</span> <span class="number">0.4545267642</span></span><br><span class="line">B <span class="number">3.111305e-22</span> <span class="number">0.008677007</span>     <span class="literal">NA</span> <span class="number">0.0001068359</span></span><br></pre></td></tr></table></figure></li><li><p>t.test &amp; pairwise.t.test <a href="http://stackoverflow.com/questions/11454521/r-t-test-and-pairwise-t-test-give-different-results" target="_blank" rel="noopener">ref</a></p><p>The problem is not in the p-value correction, but in the (declaration of the) variance assumptions. You have used var.equal=T in your t.test calls and pooled.sd=FALSE in your paired.t.test calls. However, the argument for paired.t.test is pool.sd, not pooled.sd. Changing this gives p-values equivalent to the individual calls to t.test</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pairwise.t.test(df$freq,  df$class,  p.adjust.method=<span class="string">"none"</span>,  </span><br><span class="line">                        paired=<span class="literal">FALSE</span>,  pool.sd=<span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure></li><li><p>Several ggplot pic together</p><p><img src="http://blog.genesino.com/images/heatmap-t-1-1.png" alt="Several ggplot pic together"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">data &lt;- c(<span class="number">1</span>:<span class="number">6</span>,<span class="number">6</span>:<span class="number">1</span>,<span class="number">6</span>:<span class="number">1</span>,<span class="number">1</span>:<span class="number">6</span>, (<span class="number">6</span>:<span class="number">1</span>)/<span class="number">10</span>,(<span class="number">1</span>:<span class="number">6</span>)/<span class="number">10</span>,(<span class="number">1</span>:<span class="number">6</span>)/<span class="number">10</span>,(<span class="number">6</span>:<span class="number">1</span>)/<span class="number">10</span>,<span class="number">2</span>:<span class="number">7</span>,<span class="number">7</span>:<span class="number">2</span>,<span class="number">6</span>:<span class="number">1</span>,<span class="number">1</span>:<span class="number">6</span>, <span class="number">6</span>:<span class="number">1</span>,<span class="number">1</span>:<span class="number">6</span>,<span class="number">3</span>:<span class="number">8</span>,<span class="number">7</span>:<span class="number">2</span>)</span><br><span class="line">data &lt;- as.data.frame(matrix(data, ncol=<span class="number">12</span>, byrow=<span class="literal">T</span>))</span><br><span class="line">data$type &lt;- c(rep(<span class="string">"Gene Expression"</span>,<span class="number">2</span>), rep(<span class="string">"DNA methylation"</span>,<span class="number">2</span>), rep(<span class="string">"H3K4me3"</span>,<span class="number">2</span>), rep(<span class="string">"H3K27me3"</span>,<span class="number">2</span>))</span><br><span class="line">colnames(data) &lt;- c(<span class="string">"Zygote"</span>,<span class="string">"2_cell"</span>,<span class="string">"4_cell"</span>,<span class="string">"8_cell"</span>,<span class="string">"Morula"</span>,<span class="string">"ICM"</span>,<span class="string">"ESC"</span>,<span class="string">"4 week PGC"</span>,<span class="string">"7 week PGC"</span>,<span class="string">"10 week PGC"</span>,<span class="string">"17 week PGC"</span>, <span class="string">"OOcyte"</span>, <span class="string">"type"</span>)</span><br><span class="line">data$ID &lt;- rep(c(<span class="string">"gene1"</span>,<span class="string">"gene2"</span>),<span class="number">4</span>)</span><br><span class="line"><span class="keyword">library</span>(reshape2)</span><br><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">data_m &lt;- melt(data, id.vars=c(<span class="string">"type"</span>,<span class="string">"ID"</span>))</span><br><span class="line">data_m$type &lt;- factor(data_m$type, levels=c(<span class="string">"Gene Expression"</span>, <span class="string">"DNA methylation"</span>, <span class="string">"H3K4me3"</span>,<span class="string">"H3K27me3"</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">library</span>(gridExtra)</span><br><span class="line">out &lt;- by(data=data_m, INDICES=data_m$type, FUN=<span class="keyword">function</span>(m) &#123;</span><br><span class="line">    m &lt;- droplevels(m)</span><br><span class="line">    p &lt;- ggplot(m, aes(x=variable,y=ID)) + xlab(<span class="literal">NULL</span>) + </span><br><span class="line">         labs(title=levels(m$type))  + theme_bw()  + </span><br><span class="line">         theme(panel.grid.major = element_blank()) + theme(legend.key=element_blank()) + </span><br><span class="line">         theme(axis.text.x=element_text(angle=<span class="number">45</span>,hjust=<span class="number">1</span>, vjust=<span class="number">1</span>)) + </span><br><span class="line">         theme(legend.position=<span class="string">"right"</span>) + geom_tile(aes(fill=value)) + </span><br><span class="line">         scale_fill_gradient(low = <span class="string">"white"</span>, high = <span class="string">"red"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">do.call(grid.arrange,c(out, ncol=<span class="number">1</span>))</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grid_plot = <span class="keyword">function</span>(m, hline)&#123;</span><br><span class="line">  ID = unique(m$Metabolites)</span><br><span class="line">  coords = hline[[ID]]$coord</span><br><span class="line">  text = hline[[ID]]$text</span><br><span class="line">  p &lt;- ggplot(m, aes(x=Samples, y=Concentration, color=Year, group=Year))</span><br><span class="line">  p &lt;- p + geom_line(size=<span class="number">1</span>, alpha=<span class="number">0.6</span>) + labs(title=ID) + theme(legend.position = <span class="string">"right"</span>) + expand_limits(y=<span class="number">0</span>)+ theme(axis.text.x=element_text(angle=<span class="number">45</span>,hjust=<span class="number">1</span>, vjust=<span class="number">1</span>)) + geom_hline(yintercept = coords, linetype=<span class="string">"dotted"</span>, size=<span class="number">0.5</span>) + annotate(<span class="string">"text"</span>, y=coords, x=<span class="number">0</span>, label=text, vjust=<span class="number">0</span>, hjust=<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">hline = list(H1=list(coord=c(<span class="number">5000</span>), text=c(<span class="number">5000</span>)), Glu=list(coord=c(<span class="number">50</span>), text=c(<span class="number">50</span>)), Arg..Arg.Orn.=list(coord=c(<span class="number">0.5</span>), text=c(<span class="number">0.5</span>)))</span><br><span class="line">    </span><br><span class="line">out &lt;- by(data=ctrl.m, INDICES=ctrl.m$Metabolites, FUN=grid_plot,hline)</span><br><span class="line">do.call(grid.arrange,c(out, ncol=<span class="number">1</span>))</span><br></pre></td></tr></table></figure></li><li><p>查看R包的版本 <code>installed.packages()[c(&quot;SC3&quot;), c(&quot;Package&quot;, &quot;Version&quot;)]</code></p><p>移除安装包 <code>remove.packages(c(&#39;package_name&#39;))</code></p><p>去加载已经加载的包 <code>detach(&quot;package:package_name&quot;)</code></p></li><li><p>判断一个变量是否存在</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(exists(<span class="string">"debug"</span>))&#123;</span><br><span class="line">  debug=<span class="literal">FALSE</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  debug=<span class="literal">TRUE</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="15"><li><p>stop and warn</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">warning</span>(<span class="string">"output a message after a function finishes"</span>)</span><br><span class="line"><span class="keyword">stop</span>(<span class="string">"stops the execution of the function and outputs an error message"</span>)</span><br></pre></td></tr></table></figure></li><li><p>Extract all numeric columns</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_df &lt;- df[sapply(df, is.numeric)]</span><br></pre></td></tr></table></figure></li><li><p>r-studio usages</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rstudio-server start/<span class="keyword">stop</span>/restart</span><br><span class="line">ps -u user | grep <span class="string">'rsession'</span> <span class="comment"># Kill this process when rstuido-server becomes unresponsive</span></span><br></pre></td></tr></table></figure></li></ol><ol start="18"><li><p>merge dataframes</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(data.table)</span><br><span class="line">merge(a, b, all.x=<span class="literal">T</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">a &lt;- <span class="string">"ID;Grp</span></span><br><span class="line"><span class="string">A.1;A</span></span><br><span class="line"><span class="string">A.2;A</span></span><br><span class="line"><span class="string">A.3;A</span></span><br><span class="line"><span class="string">B.3;B</span></span><br><span class="line"><span class="string">B.4;B</span></span><br><span class="line"><span class="string">C.1;C</span></span><br><span class="line"><span class="string">B.1;B</span></span><br><span class="line"><span class="string">B.2;B</span></span><br><span class="line"><span class="string">C.2;C"</span></span><br><span class="line">    </span><br><span class="line">b &lt;- <span class="string">"ID;A.1;A.2;A.3;B.1;B.2;B.3;B.4;C.1;C.2</span></span><br><span class="line"><span class="string">a;1;2;3;8;2;3;4;4;2</span></span><br><span class="line"><span class="string">b;1;3;3;1;3;3;4;1;2</span></span><br><span class="line"><span class="string">c;2;4;3;1;5;3;6;2;2"</span></span><br><span class="line">    </span><br><span class="line">sampFile &lt;- read.table(text=a, sep=<span class="string">';'</span>, row.names=<span class="number">1</span>, header=<span class="literal">T</span>)</span><br><span class="line">    </span><br><span class="line">mat &lt;- read.table(text=b, sep=<span class="string">';'</span>, header=<span class="literal">T</span>,row.names=<span class="number">1</span>)</span><br><span class="line">mat_t &lt;- t(mat)</span><br><span class="line">mat_t</span><br><span class="line">&gt; c = merge(sampFile, mat_t, by=<span class="number">0</span>)</span><br><span class="line">&gt; <span class="comment">#c = merge(sampFile, mat_t, by="row.names")  #Both work</span></span><br><span class="line">&gt; c</span><br><span class="line">  Row.names Grp a b c</span><br><span class="line"><span class="number">1</span>       A.1   A <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span>       A.2   A <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span>       A.3   A <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span>       B.1   B <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">5</span>       B.2   B <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">6</span>       B.3   B <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">7</span>       B.4   B <span class="number">4</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line"><span class="number">8</span>       C.1   C <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">9</span>       C.2   C <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line">&gt; c = dataframe(c[,-<span class="number">1</span>], row.names=c[,<span class="number">1</span>])</span><br><span class="line">&gt; c</span><br><span class="line">    Grp a b c</span><br><span class="line">A.1   A <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">A.2   A <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line">A.3   A <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line">B.1   B <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">B.2   B <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line">B.3   B <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line">B.4   B <span class="number">4</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line">C.1   C <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">C.2   C <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br></pre></td></tr></table></figure></li></ol><ol start="19"><li><p>strsplit</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sample &lt;- c(<span class="string">"a_samp1_1"</span>, <span class="string">"a_samp1_2"</span>, <span class="string">"a_samp1_3"</span>, <span class="string">"a_samp2_1"</span>, <span class="string">"a_samp2_2"</span>, <span class="string">"a_samp2_3"</span>)</span><br><span class="line"><span class="comment"># 把样品名字按 &lt;_&gt; 分割，取出其第二部分作为样品的组名</span></span><br><span class="line"><span class="comment"># lapply(X,  FUC) 对列表或向量中每个元素执行FUC操作，FUNC为自定义或R自带的函数</span></span><br><span class="line"><span class="comment">## One better way to generate group</span></span><br><span class="line">group &lt;- unlist(lapply(strsplit(sample, <span class="string">"_"</span> ), <span class="keyword">function</span>(x) x[<span class="number">2</span>]))</span><br></pre></td></tr></table></figure></li></ol><ol start="20"><li><p>Multiple rows or columns legend</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gg+guides(fill=guide_legend(nrow=<span class="number">2</span>, byrow=<span class="literal">TRUE</span>))</span><br><span class="line">gg+guides(fill=guide_legend(ncol=<span class="number">2</span>))</span><br></pre></td></tr></table></figure></li></ol><ol start="21"><li><p>条件替换数据表</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&gt; a &lt;- data.frame(a=<span class="number">1</span>:<span class="number">4</span>,b=<span class="number">1</span>:<span class="number">4</span>,c=<span class="number">1</span>:<span class="number">4</span>)</span><br><span class="line">&gt; a</span><br><span class="line">  a b c</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line">&gt; a[a$b&lt;<span class="number">3</span>,<span class="string">"b"</span>] &lt;- <span class="number">3</span></span><br><span class="line">&gt; a</span><br><span class="line">  a b c</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line">&gt; a &lt;- within(a, a[a&lt;<span class="number">4</span>] &lt;- <span class="number">2</span>)</span><br><span class="line">&gt; a</span><br><span class="line">  a b c</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line">&gt; a = matrix(<span class="number">1</span>:<span class="number">20</span>, nrow=<span class="number">4</span>)</span><br><span class="line">&gt; a</span><br><span class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>] [,<span class="number">5</span>]</span><br><span class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line">[<span class="number">4</span>,]    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line">&gt; a &lt;- as.data.frame(a)</span><br><span class="line">&gt; a$a = letters[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line">&gt; a</span><br><span class="line">  V1 V2 V3 V4 V5 a</span><br><span class="line"><span class="number">1</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">9</span> <span class="number">13</span> <span class="number">17</span> a</span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>  <span class="number">6</span> <span class="number">10</span> <span class="number">14</span> <span class="number">18</span> b</span><br><span class="line"><span class="number">3</span>  <span class="number">3</span>  <span class="number">7</span> <span class="number">11</span> <span class="number">15</span> <span class="number">19</span> c</span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">8</span> <span class="number">12</span> <span class="number">16</span> <span class="number">20</span> d</span><br><span class="line">&gt; a[,<span class="number">1</span>:<span class="number">4</span>][a[,<span class="number">1</span>:<span class="number">4</span>]&gt;<span class="number">4</span>] &lt;- <span class="number">0</span></span><br><span class="line">&gt; a</span><br><span class="line">  V1 V2 V3 V4 V5 a</span><br><span class="line"><span class="number">1</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> <span class="number">17</span> a</span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> <span class="number">18</span> b</span><br><span class="line"><span class="number">3</span>  <span class="number">3</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> <span class="number">19</span> c</span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> <span class="number">20</span> d</span><br><span class="line">&gt; a[,-<span class="number">6</span>][a[,-<span class="number">6</span>]&gt;<span class="number">4</span>] &lt;- <span class="number">0</span></span><br><span class="line">&gt; a</span><br><span class="line">  V1 V2 V3 V4 V5 a</span><br><span class="line"><span class="number">1</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> a</span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> b</span><br><span class="line"><span class="number">3</span>  <span class="number">3</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> c</span><br><span class="line"><span class="number">4</span>  <span class="number">4</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> d</span><br><span class="line">&gt; a[,-<span class="number">6</span>][a[,-<span class="number">6</span>]!=<span class="number">0</span>] &lt;- <span class="number">1</span></span><br><span class="line">&gt; a</span><br><span class="line">  V1 V2 V3 V4 V5 a</span><br><span class="line"><span class="number">1</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> a</span><br><span class="line"><span class="number">2</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> b</span><br><span class="line"><span class="number">3</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> c</span><br><span class="line"><span class="number">4</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> d</span><br><span class="line">&gt; a[c(<span class="string">"V1"</span>,<span class="string">"V2"</span>)][a[c(<span class="string">"V1"</span>,<span class="string">"V2"</span>)]==<span class="number">0</span>] &lt;- <span class="number">2</span></span><br><span class="line">&gt; a</span><br><span class="line">  V1 V2 V3 V4 V5 a</span><br><span class="line"><span class="number">1</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> a</span><br><span class="line"><span class="number">2</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> b</span><br><span class="line"><span class="number">3</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> c</span><br><span class="line"><span class="number">4</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span> d</span><br></pre></td></tr></table></figure></li></ol><ol start="22"><li><p>移除特定的行</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; a</span><br><span class="line">           [,<span class="number">1</span>]       [,<span class="number">2</span>]       [,<span class="number">3</span>]        [,<span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>,]  <span class="number">0.8248820</span> -<span class="number">1.3022177</span>  <span class="number">0.6119348</span> -<span class="number">0.04987367</span></span><br><span class="line">[<span class="number">2</span>,] -<span class="number">1.0353643</span>  <span class="number">0.7053093</span> -<span class="number">0.4677782</span>  <span class="number">0.53749134</span></span><br><span class="line">[<span class="number">3</span>,]  <span class="number">0.3773115</span>  <span class="number">0.6229525</span>  <span class="number">1.4935924</span>  <span class="number">1.50909417</span></span><br><span class="line">[<span class="number">4</span>,]  <span class="number">1.3755883</span> -<span class="number">0.2864933</span> -<span class="number">0.3077768</span> -<span class="number">0.12330547</span></span><br><span class="line">[<span class="number">5</span>,]  <span class="number">0.1286202</span> -<span class="number">0.9517153</span> -<span class="number">0.7522629</span> -<span class="number">0.13442884</span></span><br><span class="line">&gt; a[apply(a,<span class="number">1</span>,<span class="keyword">function</span>(x) &#123;mad(x)&gt;<span class="number">0.5</span>&#125;),]</span><br><span class="line">           [,<span class="number">1</span>]       [,<span class="number">2</span>]       [,<span class="number">3</span>]        [,<span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>,]  <span class="number">0.8248820</span> -<span class="number">1.3022177</span>  <span class="number">0.6119348</span> -<span class="number">0.04987367</span></span><br><span class="line">[<span class="number">2</span>,] -<span class="number">1.0353643</span>  <span class="number">0.7053093</span> -<span class="number">0.4677782</span>  <span class="number">0.53749134</span></span><br><span class="line">[<span class="number">3</span>,]  <span class="number">0.3773115</span>  <span class="number">0.6229525</span>  <span class="number">1.4935924</span>  <span class="number">1.50909417</span></span><br><span class="line">[<span class="number">4</span>,]  <span class="number">0.1286202</span> -<span class="number">0.9517153</span> -<span class="number">0.7522629</span> -<span class="number">0.13442884</span></span><br><span class="line">&gt; a[apply(a,<span class="number">1</span>,<span class="keyword">function</span>(x) &#123;any(x&lt;<span class="number">0</span>)&#125;),]</span><br><span class="line">           [,<span class="number">1</span>]       [,<span class="number">2</span>]       [,<span class="number">3</span>]        [,<span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>,]  <span class="number">0.8248820</span> -<span class="number">1.3022177</span>  <span class="number">0.6119348</span> -<span class="number">0.04987367</span></span><br><span class="line">[<span class="number">2</span>,] -<span class="number">1.0353643</span>  <span class="number">0.7053093</span> -<span class="number">0.4677782</span>  <span class="number">0.53749134</span></span><br><span class="line">[<span class="number">3</span>,]  <span class="number">1.3755883</span> -<span class="number">0.2864933</span> -<span class="number">0.3077768</span> -<span class="number">0.12330547</span></span><br><span class="line">[<span class="number">4</span>,]  <span class="number">0.1286202</span> -<span class="number">0.9517153</span> -<span class="number">0.7522629</span> -<span class="number">0.13442884</span></span><br></pre></td></tr></table></figure></li></ol><ol start="23"><li><p>colorRampPalette: generate color vectors by given colors</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">colfunc &lt;- colorRampPalette(c(<span class="string">"black"</span>,  <span class="string">"white"</span>))</span><br><span class="line">colfunc(<span class="number">10</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"#000000"</span> <span class="string">"#1C1C1C"</span> <span class="string">"#383838"</span> <span class="string">"#555555"</span> <span class="string">"#717171"</span> <span class="string">"#8D8D8D"</span> <span class="string">"#AAAAAA"</span></span><br><span class="line">[<span class="number">8</span>] <span class="string">"#C6C6C6"</span> <span class="string">"#E2E2E2"</span> <span class="string">"#FFFFFF"</span></span><br></pre></td></tr></table></figure></li></ol><ol start="24"><li><p>Trace through columns <a href="http://stackoverflow.com/questions/11767167/trying-to-apply-formula-to-each-column-in-r-how-to-feed-data-to-formula" target="_blank" rel="noopener">ref</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apply(cities, <span class="number">2</span>, FUN=<span class="keyword">function</span>(x) HoltWinters(x=x, gamma=<span class="literal">FALSE</span>))</span><br><span class="line">apply(cities, <span class="number">2</span>, HoltWinters, gamma=<span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure></li></ol><ol start="25"><li><p>从data.frame中取出一列，仍然维持是data.frame</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.frame[, <span class="number">1</span>, drop=<span class="literal">F</span>]</span><br></pre></td></tr></table></figure></li></ol><ol start="26"><li><p>Batch effects <a href="https://support.bioconductor.org/p/60581/" target="_blank" rel="noopener">ref</a></p><p>In a literal sense, getting a matrix of batch corrected counts is not possible. Once the batch effects have been removed, the values will no longer be counts.</p><p>To batch correct, it is necessary to first transform the counts to a pseudo-continuous scale. Then you can use batch correction methods developed for microarrays. This is how we usually do it.</p><p>First,put the counts in a DGEList object:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(edgeR)</span><br><span class="line">y &lt;- DGEList(counts=counts)</span><br></pre></td></tr></table></figure><p>Filter non-expressed genes:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A &lt;- aveLogCPM(y)</span><br><span class="line">y2 &lt;- y2[A&gt;<span class="number">1</span>,]</span><br></pre></td></tr></table></figure><p>Then normalize and compute log2 counts-per-million with an offset:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y2 &lt;- calcNormFactors(y2)</span><br><span class="line">logCPM &lt;- cpm(y2, log=<span class="literal">TRUE</span>, prior.count=<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>Then remove batch correct:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logCPMc &lt;- removeBatchEffect(y2, batch)</span><br></pre></td></tr></table></figure><p>Here batch is a vector or factor taking a different value for each batch group. You can input two batch vectors.</p><p>Now you can cluster the samples, for example by:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plotMDS(logCPMc)</span><br></pre></td></tr></table></figure><p>Variations on this would be use <code>rpkm()</code> instead of <code>cpm()</code>, or to give <code>removeBatchEffect()</code>a design matrix of known groups that are not batch effects.</p></li></ol><ol start="27"><li><p>Transfer number to date</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">library</span>(xlsx)</span><br><span class="line">&gt; Days &lt;- read.xlsx2(<span class="string">"Y.xlsx"</span>, sheetIndex = <span class="number">1</span>, header=<span class="literal">T</span>, stringsAsFactors=<span class="literal">F</span>)</span><br><span class="line">&gt; head(Days)</span><br><span class="line">  SampleID X.Datum.1.BE Date.of.1st.PD Date.of.death.last.follow.up</span><br><span class="line"><span class="number">1</span>   181_<span class="number">29</span>        <span class="number">40294</span>          <span class="number">40969</span>                        <span class="number">41562</span></span><br><span class="line"><span class="number">2</span>   182_<span class="number">26</span>        <span class="number">40281</span>          <span class="number">40483</span>                        <span class="number">41192</span></span><br><span class="line"><span class="number">3</span>   183_<span class="number">27</span>        <span class="number">40287</span>          <span class="number">40923</span>                        <span class="number">41562</span></span><br><span class="line"><span class="number">4</span>   184_<span class="number">32</span>        <span class="number">40297</span>          <span class="number">41014</span>                        <span class="number">41562</span></span><br><span class="line"><span class="number">5</span>   185_<span class="number">38</span>        <span class="number">40323</span>          <span class="number">40430</span>                        <span class="number">40585</span></span><br><span class="line"><span class="number">6</span>   186_<span class="number">40</span>        <span class="number">40324</span>          <span class="number">40378</span>                        <span class="number">41563</span></span><br><span class="line">&gt; Days$X.Datum.1.BE = as.Date(as.numeric(Days$X.Datum.1.BE), origin = <span class="string">"1899-12-30"</span>)</span><br><span class="line">&gt; Days$Date.of.1st.PD = as.Date(as.numeric(Days$Date.of.1st.PD), origin = <span class="string">"1899-12-30"</span>)</span><br><span class="line">&gt; head(Days)</span><br><span class="line">  SampleID X.Datum.1.BE Date.of.1st.PD Date.of.death.last.follow.up</span><br><span class="line"><span class="number">1</span>   181_<span class="number">29</span>   <span class="number">2010</span>-<span class="number">04</span>-<span class="number">26</span>     <span class="number">2012</span>-<span class="number">03</span>-<span class="number">01</span>                   <span class="number">2013</span>-<span class="number">10</span>-<span class="number">15</span></span><br><span class="line"><span class="number">2</span>   182_<span class="number">26</span>   <span class="number">2010</span>-<span class="number">04</span>-<span class="number">13</span>     <span class="number">2010</span>-<span class="number">11</span>-<span class="number">01</span>                   <span class="number">2012</span>-<span class="number">10</span>-<span class="number">10</span></span><br><span class="line"><span class="number">3</span>   183_<span class="number">27</span>   <span class="number">2010</span>-<span class="number">04</span>-<span class="number">19</span>     <span class="number">2012</span>-<span class="number">01</span>-<span class="number">15</span>                   <span class="number">2013</span>-<span class="number">10</span>-<span class="number">15</span></span><br><span class="line"><span class="number">4</span>   184_<span class="number">32</span>   <span class="number">2010</span>-<span class="number">04</span>-<span class="number">29</span>     <span class="number">2012</span>-<span class="number">04</span>-<span class="number">15</span>                   <span class="number">2013</span>-<span class="number">10</span>-<span class="number">15</span></span><br><span class="line"><span class="number">5</span>   185_<span class="number">38</span>   <span class="number">2010</span>-<span class="number">05</span>-<span class="number">25</span>     <span class="number">2010</span>-<span class="number">09</span>-<span class="number">09</span>                   <span class="number">2011</span>-<span class="number">02</span>-<span class="number">11</span></span><br><span class="line"><span class="number">6</span>   186_<span class="number">40</span>   <span class="number">2010</span>-<span class="number">05</span>-<span class="number">26</span>     <span class="number">2010</span>-<span class="number">07</span>-<span class="number">19</span>                   <span class="number">2013</span>-<span class="number">10</span>-<span class="number">16</span></span><br></pre></td></tr></table></figure></li></ol><ol start="28"><li><p>Rstudio set dynamic library and other environment variables</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sys.getenv()</span><br><span class="line"><span class="comment"># will list all environmental variables</span></span><br><span class="line">Sys.getenv(<span class="string">'LD_LIBRARY_PATH'</span>)</span><br><span class="line">Sys.setenv(LD_LIBRARY_PATH=paste(<span class="string">"/my_lib_dir"</span>, Sys.getenv(<span class="string">'LD_LIBRARY_PATH'</span>), sep=<span class="string">":"</span>))</span><br></pre></td></tr></table></figure></li></ol><ol start="29"><li><p>maximal number of DLLs reached</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /miniconda2/envs/r/lib/R/etc/Renviron</span></span><br><span class="line">R_MAX_NUM_DLLS=<span class="number">1000</span></span><br></pre></td></tr></table></figure></li></ol><ol start="30"><li><p>Remove one value from vector</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[!a==<span class="number">4</span>]</span><br></pre></td></tr></table></figure></li></ol><ol start="31"><li><p>Do not transfer numbers to scientific format</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">options(scigen=<span class="number">999</span>)</span><br></pre></td></tr></table></figure></li></ol><ol start="32"><li><p>Rmarkdown to markdown</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmarkdown::render(<span class="string">"05.biotools.Rmd"</span>, output_format = <span class="string">"md_document"</span>,output_file = <span class="string">"test.md"</span>)</span><br></pre></td></tr></table></figure></li></ol><ol start="33"><li><p>curl not work</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone github_package</span><br><span class="line">R CMD build github_package</span><br><span class="line">R CMD install github_package</span><br><span class="line"></span><br><span class="line">install.packages(<span class="string">"github_url"</span>, repos=<span class="literal">NULL</span>, type=<span class="string">"source"</span>)</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>要掌握的技能[持续更新中]</title>
      <link href="/post/%E8%A6%81%E6%8E%8C%E6%8F%A1%E7%9A%84%E6%8A%80%E8%83%BD/"/>
      <url>/post/%E8%A6%81%E6%8E%8C%E6%8F%A1%E7%9A%84%E6%8A%80%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h3 id="我自己找的内容"><a href="#我自己找的内容" class="headerlink" title="我自己找的内容"></a>我自己找的内容</h3><h4 id="计算机基础："><a href="#计算机基础：" class="headerlink" title="计算机基础："></a>计算机基础：</h4><h5 id="awk："><a href="#awk：" class="headerlink" title="awk："></a>awk：</h5><ul><li><p><a href="https://zhuanlan.zhihu.com/p/62382028" target="_blank" rel="noopener">生物信息 awk 简明教程和基本用法</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/63107708" target="_blank" rel="noopener">生物信息 awk 用法进阶</a></p></li></ul><h5 id="python"><a href="#python" class="headerlink" title="python:"></a>python:</h5><ul><li><a href="https://mp.weixin.qq.com/s/T5WAeI5WQKV1wAMxQVES4w" target="_blank" rel="noopener">30段极简Python代码</a></li></ul><h5 id="MySQL："><a href="#MySQL：" class="headerlink" title="MySQL："></a>MySQL：</h5><ul><li><a href="https://zhuanlan.zhihu.com/p/71232689" target="_blank" rel="noopener">1000行MySQL学习笔记</a></li></ul><h4 id="绘图用："><a href="#绘图用：" class="headerlink" title="绘图用："></a>绘图用：</h4><h5 id="python绘图："><a href="#python绘图：" class="headerlink" title="python绘图："></a>python绘图：</h5><ul><li><a href="https://zhuanlan.zhihu.com/p/53308606" target="_blank" rel="noopener">Matplotlib 可视化的 50 个图表</a></li></ul><h5 id="R绘图："><a href="#R绘图：" class="headerlink" title="R绘图："></a>R绘图：</h5><ul><li><p><a href="https://zhuanlan.zhihu.com/p/34514379" target="_blank" rel="noopener">ggplot2(一)‖基本概念</a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247486262&idx=1&sn=d38221a4063d866b1f10f4c9ebab5f88&chksm=ec0dcebcdb7a47aa03ff27872048304d33be27d1ab8bd3af0aefc320366a4bd3aceb943cb384&scene=21#wechat_redirect" target="_blank" rel="noopener">ggplot2高效实用指南 (可视化脚本、工具、套路、配色)</a></p></li><li><p><a href="https://mp.weixin.qq.com/s/W2nKMe4u2VLBswFkvhoXDw" target="_blank" rel="noopener">图片的组合与拼接</a></p></li></ul><a id="more"></a><h5 id="色彩搭配："><a href="#色彩搭配：" class="headerlink" title="色彩搭配："></a>色彩搭配：</h5><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247485182&idx=1&sn=7b5c1d800560eddcf898ed410720a2a3&scene=21#wechat_redirect" target="_blank" rel="noopener">图表色彩运用原理</a></li></ul><h4 id="文章图排版"><a href="#文章图排版" class="headerlink" title="文章图排版"></a>文章图排版</h4><ul><li><p><a href="https://mp.weixin.qq.com/s/IJNyhinakY0lSXgCN7b9ug" target="_blank" rel="noopener">文章用图的修改和排版</a></p></li><li><p><a href="https://mp.weixin.qq.com/s/HTsufk71U3wf14OOWSKEeQ" target="_blank" rel="noopener">文章用图的修改和排版(2)</a></p></li></ul><h3 id="转自公众号生信宝典的内容："><a href="#转自公众号生信宝典的内容：" class="headerlink" title="转自公众号生信宝典的内容："></a>转自公众号生信宝典的内容：</h3><p><a href="https://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484250&idx=2&sn=1bad22e1e0018d9108ddafca561180b0&scene=21#wechat_redirect" target="_blank" rel="noopener">生信宝典文章集锦</a></p><p><a href="http://blog.genesino.com/2100/01/shengxinbaodian/" target="_blank" rel="noopener">http://blog.genesino.com/2100/01/shengxinbaodian/</a></p><p>以下是详细内容，<em>Jump to…</em></p><h4 id="程序学习心得"><a href="#程序学习心得" class="headerlink" title="程序学习心得"></a>程序学习心得</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483927&idx=1&sn=23adf2b9d13400f2081f790e674e2cba&chksm=ec0dc79ddb7a4e8b5bb7a413744319a90f425371b30e2c85224b7c183cc4ad4bbd5d9749bb7b&scene=21#wechat_redirect" target="_blank" rel="noopener">生物信息之程序学习</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483955&idx=1&sn=946438376f94af6e8861b2b42701914e&chksm=ec0dc7b9db7a4eafbef28fac1fb260f6f876f0ba674828784ac827dd23f9317f5a2d59d38bc0&scene=21#wechat_redirect" target="_blank" rel="noopener">如何优雅的提问</a></li></ul><h4 id="Linux-学习"><a href="#Linux-学习" class="headerlink" title="Linux 学习"></a>Linux 学习</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483783&idx=1&sn=fae66023fcef633cac9c6c7728963682&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习-文件和目录</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483810&idx=1&sn=10063c5f8fd7106a60bceb8563ba88cb&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习-文件操作</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483819&idx=1&sn=96ebfbcdf56693edbfea0c9e502c33ce&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux文件内容操作</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483872&idx=1&sn=7fb7e57b3ff5c06ebaff344370c8b4c8&chksm=ec0dc46adb7a4d7cc125ab3cf8361bf3e3fcf858edca7d7987d52bce3e9e3aa0b7d8f8f2adfa&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习-环境变量和可执行属性</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483923&idx=1&sn=eb764e59cfc12b98e3eb4240ac350330&chksm=ec0dc799db7a4e8f9dc3a64760253a554d3241446005040ad721070bafb237f405b173c11ef4&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习 - 管道、标准输入输出</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483954&idx=1&sn=11247591a6ef98a4d25404278d577ed0&chksm=ec0dc7b8db7a4eaeb7ae3fd2fa2fbfa7bfd13f5e90d7a42d405f6f8e8783761de048f7ccbc58&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习 - 命令运行监测和软件安装</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483873&idx=1&sn=6e2b9ddb6ba61c49d834bcfba6703c5c&chksm=ec0dc46bdb7a4d7d6d1232390f6f8843607b37ecca7938d19c20404dff0cf01aebfff77a0cdd&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习-常见错误和快捷操作</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483952&idx=1&sn=5312e0bab13182b118376018cb69674b&chksm=ec0dc7badb7a4eacb5d96d971df6ccd940435b7525962963e625736efd2a413ae76844c3ee48&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习-文件列太多，很难识别想要的信息在哪列；别焦急，看这里。</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483823&idx=1&sn=ac62450f0475dc9513e75009f0670f45&chksm=ec0dc425db7a4d3300f547caeaee709425dd0a41c86be18aab44d41619a4d18944289b0deaf8&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux学习-文件排序和FASTA文件操作</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483840&idx=1&sn=f87f6dd703cd8c109f6dc5b8d12ffb7c&chksm=ec0dc44adb7a4d5c9ff2422c730b1d7bb18dcb6947c0e7449f1678aee492c3193302174930b4&scene=21#wechat_redirect" target="_blank" rel="noopener">用了Docker，妈妈再也不担心我的软件安装了 - 基础篇</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483950&idx=1&sn=6f4dbc46a064638d7c95b9f99cb1de70&chksm=ec0dc7a4db7a4eb20751dd6567b1c97be7d536671af07707eb57bb1ea7865cbde17a0226a6e0&scene=21#wechat_redirect" target="_blank" rel="noopener">Linux服务器数据定期同步和备份方式</a></li></ul><h4 id="R统计和作图"><a href="#R统计和作图" class="headerlink" title="R统计和作图"></a>R统计和作图</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483869&idx=1&sn=039651fa8fa9746bee6c9139b60c268e&chksm=ec0dc457db7a4d4101629f584bf291a38cea3609e3d4fc406255b2b96e6db7184462374714e0&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 入门环境Rstudio</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483882&idx=1&sn=e16903b4b745a1ef51855be3824149f6&chksm=ec0dc460db7a4d76a70bd4ca2d250f147225252ee963d3e577affaebeeb81dea1ff639d5e9aa&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 入门环境Rstudio</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483889&idx=1&sn=9c9970cb120ac1e976713aca558ac9bf&chksm=ec0dc47bdb7a4d6d6441e36055aa075b03d5592862eae01c05761e5972b39a62cf2228b19787&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 热图绘制 (heatmap)</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483891&idx=1&sn=40daf6435398c4d9a41f332e9bba4915&chksm=ec0dc479db7a4d6fec413bfb90a4660eb035b440d2bbee998114f7af29e3b3338a8adf62540a&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 基础概念和矩阵操作</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483921&idx=1&sn=8326bc566e945386cad27250a33a1bf6&chksm=ec0dc79bdb7a4e8d28bb909994432dab9bf09346b6f64a35ec1e657cbb298f10ca20c6838ca7&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 热图简化</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483901&idx=1&sn=5770a863352acd8f8aec3e157131bef8&chksm=ec0dc477db7a4d61e5ee49323529d5b406941f0b2ebb63a8a8e7f35b28b97ada059692671c5b&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 热图美化</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483937&idx=1&sn=8368c9346ccce10121c8a7b574c12f88&chksm=ec0dc7abdb7a4ebd859713b8740b53f148e3ebb5047776e9cf42f2306ab082b6b968568f2f23&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 线图绘制</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483947&idx=1&sn=7cf0252efff5433447507b977fcaff97&chksm=ec0dc7a1db7a4eb77a269709bdf2c8ab51bcad89aa780ec0be171a333e1cb8f3cc27eff277a1&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 线图一步法</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483964&idx=1&sn=ee52ac37fb9a919f5c75c0abe2a49ad4&chksm=ec0dc7b6db7a4ea0a51306347fc43265c41fda3eeaf4764ddc3795546371327579676cd74a38&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 箱线图（小提琴图、抖动图、区域散点图）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483971&idx=1&sn=1b40a1137ccb8b2fa1ab3eb1d0f05de9&chksm=ec0dc7c9db7a4edf16ea4966b9acb7f23cd23bd6a2e59450ae11bdac899fa2fceb124264dcf4&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 箱线图一步法</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483996&idx=1&sn=9a29d52e78e9acffeb0a78077a14f9f2&chksm=ec0dc7d6db7a4ec0163259e81e4ded54875a5dd8adaafbc6975a86c71223d863627ba37801e5&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 火山图</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483978&idx=1&sn=e0c158c0e92375553036cc37f4987e40&chksm=ec0dc7c0db7a4ed6ac593493b7d8b52f11f2feb92d24fa00d19527fbb6f95b24f7e313ef9440&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 富集分析泡泡图 （文末有彩蛋）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484056&idx=1&sn=f9b2b4f7495b432e9294b7cbf42eaf33&chksm=ec0dc712db7a4e04769d322558364b4b401b0a8153097c7252e83170e9201a31c2a7abbaf101&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 散点图绘制</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484036&idx=1&sn=22ee356d0c9680d56dada1b777985ed2&chksm=ec0dc70edb7a4e182a21475e9ddcde35b907c291549cc8c2e767be260af445ff5455aa358b04&scene=21#wechat_redirect" target="_blank" rel="noopener">一文看懂PCA主成分分析</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484063&idx=1&sn=f4e93d428e4910b4abbee9c0430cd170&chksm=ec0dc715db7a4e0318b388ba2ab3d51677741421c42ada474a0ac6046a0699283014eae84b6f&scene=21#wechat_redirect" target="_blank" rel="noopener">富集分析DotPlot，可以服</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484076&idx=1&sn=fa5af19a2a4db4b0c5c7f145bf93ca57&chksm=ec0dc726db7a4e30fe7a0492ed9ea8eb5fa1c34641b1442a2da003efde0546b30c48fde3f118&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 韦恩图</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484134&idx=1&sn=ffb41298eae74834af2f5dad05d37921&chksm=ec0dc76cdb7a4e7a852ac0670532c12c690399f140a2335f640eaf01f7da26bc5480941686a9&scene=21#wechat_redirect" target="_blank" rel="noopener">R语言学习 - 柱状图</a></li></ul><h4 id="NGS基础"><a href="#NGS基础" class="headerlink" title="NGS基础"></a>NGS基础</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484047&idx=1&sn=3e2a79d9f56040a57ac2e16cf1923b54&chksm=ec0dc705db7a4e133e6e91de9ac11a6c0690f03d7b3b760b358e9b0d1a2d57974599419d9fff&scene=21#wechat_redirect" target="_blank" rel="noopener">NGS基础 - FASTQ格式解释和质量评估</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484034&idx=1&sn=e7680ee935f8603214227b37eeb2c567&chksm=ec0dc708db7a4e1eca4e38845381f328c49c84a90ad6580c3ba3761511772636e5ec0f185931&scene=21#wechat_redirect" target="_blank" rel="noopener">NGS基础 - 高通量测序原理</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484148&idx=1&sn=525233898721a9c3ebdf275babf14944&chksm=ec0dc77edb7a4e686440e0cbe5fbf39f554c4183dc30e7870ab7584e285f4e018dd94b680f79&scene=21#wechat_redirect" target="_blank" rel="noopener">NGS基础 - 参考基因组和基因注释文件</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484166&idx=1&sn=417e155672bd718def86003b16bf0078&chksm=ec0dc68cdb7a4f9a6bcb62c18797a69040173e2b0af20f1cf87d3e0d75e3adee03c7ff524dc5&scene=21#wechat_redirect" target="_blank" rel="noopener">NGS基础 - GTF/GFF文件格式解读和转换</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484167&idx=1&sn=ef9699899164d23013d92b61331c6562&chksm=ec0dc68ddb7a4f9bfb83b9942196622f8b8f52b041d3f4a12786e6464752fbeaf64c9a640e39&scene=21#wechat_redirect" target="_blank" rel="noopener">本地安装UCSC基因组浏览器</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483946&idx=1&sn=3f95769229f28a91ed8bf5889e2181be&chksm=ec0dc7a0db7a4eb64d08c7799cfe698a1662e6d0d935a8b91c6c969aae86900df4decc469a0d&scene=21#wechat_redirect" target="_blank" rel="noopener">测序数据可视化 (一)</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483843&idx=1&sn=43770d21f6c2da2393c31cd55fdbe31e&chksm=ec0dc449db7a4d5f723842286bf7feab7830eba5d9778d351569810a069e5ace76040f94a6bd&scene=21#wechat_redirect" target="_blank" rel="noopener">测序文章数据上传找哪里</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484106&idx=1&sn=687a0def51f6ea91a335754eb3dc9ca9&chksm=ec0dc740db7a4e564e5b1e93a36e5d9447581e262eec9c2983d1d4e76788d673c9c07dec8f8e&scene=21#wechat_redirect" target="_blank" rel="noopener">39个转录组分析工具，120种组合评估(转录组分析工具哪家强-导读版)</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484106&idx=2&sn=a09fa127d625c4072ae0343795346c56&chksm=ec0dc740db7a4e56821f32f60700027c85db46e81089721d1bbe23ceefa86160d9661c2f2d4c&scene=21#wechat_redirect" target="_blank" rel="noopener">39个转录组分析工具，120种组合评估(转录组分析工具大比拼 （完整翻译版）)</a></li></ul><h4 id="Python学习"><a href="#Python学习" class="headerlink" title="Python学习"></a>Python学习</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483866&idx=1&sn=310341a1c8d348958c304df03dfd06a0&chksm=ec0dc450db7a4d46e369637cd2867b0e56389bf4f2e1d0dce409bba38882e61e5063308a13af&scene=21#wechat_redirect" target="_blank" rel="noopener">Python学习极简教程 （一）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483866&idx=2&sn=bf3c07ee1b2936c7ea06b5d4ca820545&chksm=ec0dc450db7a4d469f4f625babfb595b068137ea2b25a7682f9fb58ff771db6543f43def7950&scene=21#wechat_redirect" target="_blank" rel="noopener">Python学习教程（二）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483866&idx=3&sn=dec66c5f3f12919ce1b0bfbb545e3935&chksm=ec0dc450db7a4d46e91b65446d6a192056ab6ff27c019fe3770cc32816b0ae3f16659ebba0a5&scene=21#wechat_redirect" target="_blank" rel="noopener">Python学习教程（三）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483866&idx=4&sn=3a0b0c5c0f736ddeadc4524bae8b2a91&chksm=ec0dc450db7a4d465602b74e0fa968519a3a085a1901b5cca97ff886163422a24089378ff8f0&scene=21#wechat_redirect" target="_blank" rel="noopener">Python学习教程 （四）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483866&idx=5&sn=fd3526e11c4adf8194e1f92cd6d1749c&chksm=ec0dc450db7a4d468c7d114352153eecbaedd7d37065f681caa28b74258a92038d1d2030056b&scene=21#wechat_redirect" target="_blank" rel="noopener">Python学习教程（五）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483866&idx=6&sn=ef7a0972abc002cfeba27815020e83aa&chksm=ec0dc450db7a4d46f61328946fe257a1516785fb9a1f7c1663e86e4255ae6b616e3c07ac1cb0&scene=21#wechat_redirect" target="_blank" rel="noopener">Python学习教程 （六）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483865&idx=1&sn=a2e1474bbebce343ff4262e38653f4c4&chksm=ec0dc453db7a4d45349076b1627eff5e292abceada59e832a46553f4ca614d62df96e097f871&scene=21#wechat_redirect" target="_blank" rel="noopener">Pandas，让Python像R一样处理数据，但快</a></li></ul><h4 id="NGS软件"><a href="#NGS软件" class="headerlink" title="NGS软件"></a>NGS软件</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483831&idx=1&sn=718242148bb1cfe03140f4d8c3c3005f&chksm=ec0dc43ddb7a4d2bb6e3c5c9169dbd9883fc4b68d9f68e4931e6b8a709f5265ad0ddeab68e04&scene=21#wechat_redirect" target="_blank" rel="noopener">Rfam 12.0+本地使用 （最新版教程）</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483853&idx=1&sn=b3350a1c2e2f3ea66f2891d3521a90aa&chksm=ec0dc447db7a4d516eb1255d09ce53cfa1f1dcda9de610193ea900c2f39b882e595d2e0f10e7&scene=21#wechat_redirect" target="_blank" rel="noopener">轻松绘制各种Venn图</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483988&idx=1&sn=d87d8f70ee4098a1f8340a753c8cbb56&chksm=ec0dc7dedb7a4ec8da9143e0ef8e8c11d44ad54e7fb145e60f65fa09a431a26ec1971916af06&scene=21#wechat_redirect" target="_blank" rel="noopener">ETE构建、绘制进化树</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484159&idx=1&sn=81dc70116b26b363ea2efeb7d6034dff&chksm=ec0dc775db7a4e6330ae462efe39f174257dae34e76fec91715da3b8a09bc694abbab9c3f5c8&scene=21#wechat_redirect" target="_blank" rel="noopener">psRobot：植物小RNA分析系统</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484235&idx=1&sn=1afa3b9b954e9f8bb99d954a5305681c&chksm=ec0dc6c1db7a4fd7098a872b887f8e077aa2d1fcf101614df050524d945eceda54150ecebc72&scene=21#wechat_redirect" target="_blank" rel="noopener">生信软件系列 - NCBI使用</a></li></ul><h4 id="Cytoscape网络图"><a href="#Cytoscape网络图" class="headerlink" title="Cytoscape网络图"></a>Cytoscape网络图</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483677&idx=1&sn=6cf08247205c2abfecc9d2e4927ca210&scene=21#wechat_redirect" target="_blank" rel="noopener">Cytoscape教程1</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484184&idx=1&sn=2384ba8a6a6ea3ed7dac1b42217c710a&chksm=ec0dc692db7a4f84a03feb4de092aa0712b1bca2975f1cee8fac8342d0a65f836f5f94e9d877&scene=21#wechat_redirect" target="_blank" rel="noopener">Cytoscape之操作界面介绍</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484194&idx=1&sn=61bcbe1c48e195c5c830396865789723&chksm=ec0dc6a8db7a4fbeaa9cdd7245127edd382f3e4d13a61636c2cbc52062b32d7565bf282fca5e&scene=21#wechat_redirect" target="_blank" rel="noopener">新出炉的Cytoscape视频教程</a></li></ul><h4 id="分子对接"><a href="#分子对接" class="headerlink" title="分子对接"></a>分子对接</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483842&idx=1&sn=653e97fb32eaa73ce9f26b22306cc369&chksm=ec0dc448db7a4d5ef15d62d62df9e3a243a7e304c816c2a6ac3f878b07ede52010900e7c9136&scene=21#wechat_redirect" target="_blank" rel="noopener">来一场蛋白和小分子的风花雪月</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483842&idx=3&sn=caa5bb8ab6c868b8644c5f532b12adf2&chksm=ec0dc448db7a4d5e9827d5419b08a8930b27c53d80d21c207f15be3a27eedc6fa1088de709f7&scene=21#wechat_redirect" target="_blank" rel="noopener">不是原配也可以-对接非原生配体</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483842&idx=2&sn=c3c3f80b2e24ee5287678e4a853fb657&chksm=ec0dc448db7a4d5e3a023a2067552d29ee5fca143192771d8d8570f9c9c8f65b13829360f487&scene=21#wechat_redirect" target="_blank" rel="noopener">简单可视化-送你一双发现美的眼睛</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483842&idx=4&sn=8b7918a98e5e34f78263f248620d8311&chksm=ec0dc448db7a4d5ec2a83703149caed48fa5afbe4822e855785448008e34a9991d9f428d8fec&scene=21#wechat_redirect" target="_blank" rel="noopener">你需要知道的那些前奏</a></li></ul><h4 id="生信宝典之傻瓜式"><a href="#生信宝典之傻瓜式" class="headerlink" title="生信宝典之傻瓜式"></a>生信宝典之傻瓜式</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247484030&idx=1&sn=0d369c99fd49ebafefe60c00efe647b1&chksm=ec0dc7f4db7a4ee241beb0fb8a3e5d8bf7e9ac69899db9b6b6522093bda21e5a2202ddf1edda&scene=21#wechat_redirect" target="_blank" rel="noopener">生信宝典之傻瓜式 (一) 如何提取指定位置的基因组序列</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483852&idx=1&sn=d419fa404b987b4d70f789eb2de8478c&chksm=ec0dc446db7a4d50e4700d88f42d3991ea622a058f1529586b533648dcee994e08f742133abe&scene=21#wechat_redirect" target="_blank" rel="noopener">生信宝典之傻瓜式 (二) 如何快速查找指定基因的调控网络</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483864&idx=1&sn=c1df1a797a4c2e4cf5f0e0524664bebd&chksm=ec0dc452db7a4d44a97031725ae4630bdbec7e37076144d60dfd83e17d04cd8a7003f039ecc0&scene=21#wechat_redirect" target="_blank" rel="noopener">生信宝典之傻瓜式 (三) 我的基因在哪里发光 - 如何查找基因在发表研究中的表达</a></li></ul><h4 id="生信人写程序"><a href="#生信人写程序" class="headerlink" title="生信人写程序"></a>生信人写程序</h4><ul><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483837&idx=1&sn=660358a38b7fa6d3de2c95280f7a4535&chksm=ec0dc437db7a4d21368b312ac43ceae552e1544570639c949e96bf488113a55f67fa2306008e&scene=21#wechat_redirect" target="_blank" rel="noopener">生信人写程序1. Perl语言模板及配置</a></li><li><a href="http://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247483910&idx=1&sn=7813eaa4841d90b0bfc3982bb901de81&chksm=ec0dc78cdb7a4e9a866f3e0cade3096a13366cac18c873820434f066fdba9bd22a7b5b3d210d&scene=21#wechat_redirect" target="_blank" rel="noopener">生信人写程序2. Editplus添加Perl, Shell, R, markdown模板和语法高亮</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>TCGA 生存信息</title>
      <link href="/post/TCGA-%E7%94%9F%E5%AD%98%E4%BF%A1%E6%81%AF/"/>
      <url>/post/TCGA-%E7%94%9F%E5%AD%98%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<p>overall survival (OS) 总生存期</p><p>recurrence free survival (RFS) 无复发生存期</p><a id="more"></a><h2 id="TCGA-STAD的表型基础信息统计"><a href="#TCGA-STAD的表型基础信息统计" class="headerlink" title="TCGA STAD的表型基础信息统计"></a>TCGA STAD的表型基础信息统计</h2><p>以胃癌的生存信息为例，一共有6列。</p><ul><li>sample：样本名称</li><li>X_EVENT： 1表示死亡，0表示审查中，null表示没有数据    </li><li>X_PATIENT：</li><li>X_TIME_TO_EVENT：</li><li>X_OS_IND：</li><li>X_OS：如果有死亡，相当于days to death；如果仍然存活，时间点为days_to_last_known_alive,和days_to_last_followup中较大值。</li></ul><ul><li>基本的生存信息统计：<ul><li>506个样本，来自于418个病例，其中170人已经死亡，剩余248人存活状态</li><li></li></ul></li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 从UCSC xena下载生存和表型数据</span></span><br><span class="line">survival &lt;- read.table(<span class="string">"../phenotype/TCGA-STAD.survival.tsv.gz"</span>,header = <span class="literal">T</span>, sep = <span class="string">"\t"</span>, quote = <span class="string">""</span>, fill = <span class="literal">T</span>)</span><br><span class="line">phe=read.table(<span class="string">'../phenotype/TCGA-STAD.GDC_phenotype.tsv.gz'</span>,header = <span class="literal">T</span>,sep = <span class="string">'\t'</span>,quote = <span class="string">""</span>,fill = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">dim(phe)</span><br><span class="line"><span class="comment">## [1] 544 137</span></span><br><span class="line">dim(survival)</span><br><span class="line"><span class="comment">## [1] 506   6</span></span><br><span class="line">length(unique(phe.filter$submitter_id.samples))</span><br><span class="line"><span class="comment">## [1] 506  </span></span><br><span class="line">phe.filter &lt;- phe[phe$submitter_id.samples %<span class="keyword">in</span>% survival$sample,]</span><br><span class="line"><span class="comment">## phe.filter中样本是一一对应的，两者都含有506个样本。</span></span><br><span class="line"><span class="comment">## phe多出来的一些样本是新提取的肿瘤来源的数据。</span></span><br><span class="line"><span class="comment">## 为什么要重新提取？可能是经过治疗后出现了新的肿瘤，重新采样</span></span><br><span class="line"><span class="comment">## （new_tumor_event_after_initial_treatment）</span></span><br><span class="line">dim(phe.filter)  </span><br><span class="line"><span class="comment">## [1] 506 137</span></span><br><span class="line"></span><br><span class="line">length(unique(survival$sample))</span><br><span class="line"><span class="comment">## 506</span></span><br><span class="line">length(unique(survival$X_PATIENT))</span><br><span class="line"><span class="comment">## 418</span></span><br><span class="line">tmp &lt;- unique(survival[,c(<span class="number">2</span>,<span class="number">3</span>)])</span><br><span class="line">table(tmp$X_EVENT)</span><br><span class="line"><span class="comment">##   0   1 </span></span><br><span class="line"><span class="comment">## 248 170</span></span><br></pre></td></tr></table></figure><p><img src="/_posts/images/1566463192358.png" alt></p><p>survival[survival$X_EVENT==survival$X_OS_IND,]</p><p>UCSC Cancer Browser team curate the overall survival (OS) and recurrence free survival (RFS) information from the TCGA clinical and phenotypic data.   </p><p><strong>Overall Survival (OS)</strong> The <em>event</em> call is derived from “<em>vital status”</em> parameter. The <em>time_to_event</em> is in days, equals to days_to_death if patient deceased; in the case of a patient is still living, the time variable is the maximum(days_to_last_known_alive, days_to_last_followup).  This pair of clinical parameters are called _EVENT and _TIME_TO_EVENT on the cancer browser. </p><p><strong>Recurrence Free Survival (RFS)</strong> The <em>event</em> call is derived from “<em>new_tumor_event_after_initi**al_treatment”</em> parameter. The <em>time_to_event</em> is in days, equals to max (days_to_new_tumor_event_after_initial_treatment, days_to_tumor_recurrence) if there is an event; in the case of no event, the time variable is time of overall survival. The pair of clinical parameters are called _RFS and _RFS_IND on the cancer browser. </p><p><strong>KM plot</strong></p><p>If there is OS data, the browser KM plot will display by default.  Users can use the KM plot advanced option to select other clinical variables, such _RFS and _RFS_IND to use for KM plot.</p><p>如果有OS数据，默认情况下将显示浏览器KM图。 用户可以使用KM plot advanced选项选择其他临床变量，例如_RFS和_RFS_IND用于KM图。</p><p><strong>Example: TCGA bladder cancer recurrent free survival KM plot</strong></p><p><a href="https://genome-cancer.ucsc.edu/proj/site/hgHeatmap/#?bookmark=090a0ed5cf614b35d1002c0ddeb044aa" target="_blank" rel="noopener">https://genome-cancer.ucsc.edu/proj/site/hgHeatmap/#?bookmark=090a0ed5cf614b35d1002c0ddeb044aa</a> and then <strong>click the KM button</strong></p><p><strong>Download OS or RFS data for survival statistical analysis</strong></p><p>You can download the OS and OS_IND and RFS and RFS_IND pair of data through clinical download, as well as the categorical clinical variable (e.g. PAM50 subtype) for survival analysis. The downloaded data is a text file, data is in the format that can be easily used by R (e.g. survdiff in the survival package) to derive p value. Please note to select “entire clinical cohort” option when download clinical data for survival analysis.</p><p>您可以通过下载临床数据以及用于生存分析的分类临床变量（例如PAM50亚型）下载OS和OS_IND以及RFS和RFS_IND数据对。 下载的数据是文本文件，数据的格式可以由R（例如生存包中的生存者）容易地使用以导出p值。 请注意在下载临床数据进行生存分析时选择“整个临床队列”选项。</p><p>参考<a href="https://groups.google.com/forum/#!topic/ucsc-cancer-genomics-browser/YvKnWZSsw1Q" target="_blank" rel="noopener">https://groups.google.com/forum/#!topic/ucsc-cancer-genomics-browser/YvKnWZSsw1Q</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>创建python虚拟环境</title>
      <link href="/post/python-venv/"/>
      <url>/post/python-venv/</url>
      
        <content type="html"><![CDATA[<p>virtualenv可创建一套“隔离”的Python运行环境，从而避免不同版本包的干扰。</p><a id="more"></a><h3 id="pip安装virtualenv"><a href="#pip安装virtualenv" class="headerlink" title="pip安装virtualenv"></a>pip安装virtualenv</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install virtualenv</span><br></pre></td></tr></table></figure><h3 id="创建独立python运行环境"><a href="#创建独立python运行环境" class="headerlink" title="创建独立python运行环境"></a>创建独立python运行环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建目录</span></span><br><span class="line">mkdir project_A</span><br><span class="line">cd project_A</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建独立的python运行环境</span></span><br><span class="line">virtualenv --no-site-packages venv</span><br></pre></td></tr></table></figure><h3 id="进入虚拟环境"><a href="#进入虚拟环境" class="headerlink" title="进入虚拟环境"></a>进入虚拟环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source venv/bin/activate</span><br></pre></td></tr></table></figure><h3 id="在虚拟环境下安装第三方包"><a href="#在虚拟环境下安装第三方包" class="headerlink" title="在虚拟环境下安装第三方包"></a>在虚拟环境下安装第三方包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install numpy</span><br></pre></td></tr></table></figure><h3 id="关闭虚拟环境"><a href="#关闭虚拟环境" class="headerlink" title="关闭虚拟环境"></a>关闭虚拟环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deactivate</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> virtualenv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>download_TCGA_from_GDC</title>
      <link href="/post/%E8%82%BF%E7%98%A4%20download-TCGA-from-GDC/"/>
      <url>/post/%E8%82%BF%E7%98%A4%20download-TCGA-from-GDC/</url>
      
        <content type="html"><![CDATA[<a id="more"></a>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>设置仓库镜像和安装R包</title>
      <link href="/post/R-packages-installation/"/>
      <url>/post/R-packages-installation/</url>
      
        <content type="html"><![CDATA[<p>以安装生存分析包<code>survminer</code>为例，了解R包的一般安装流程。</p><a id="more"></a><h3 id="Set-repo-to-accelerate-downloading"><a href="#Set-repo-to-accelerate-downloading" class="headerlink" title="Set repo to accelerate downloading"></a>Set repo to accelerate downloading</h3><p>For CRAN:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">options(repos=structure(c(CRAN="https://mirrors.tuna.tsinghua.edu.cn/CRAN/")))</span><br></pre></td></tr></table></figure><p>For bioconductor:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">options(BioC_mirror="http://mirrors.ustc.edu.cn/bioc/")</span><br></pre></td></tr></table></figure><h3 id="Installation-and-loading"><a href="#Installation-and-loading" class="headerlink" title="Installation and loading"></a>Installation and loading</h3><p>Install from <a href="https://cran.r-project.org/package=survminer" target="_blank" rel="noopener">CRAN</a> as follow:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install.packages("survminer")</span><br></pre></td></tr></table></figure><p>Install from bioconductor（因为<code>survminer</code>并不在bioconductor中，此处我随机找了别的包示例）:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;)</span><br><span class="line">if (!requireNamespace(&quot;ivygapSE&quot;, quietly = TRUE)) BiocManager::install(&quot;ivygapSE&quot;)</span><br></pre></td></tr></table></figure><p>Or, install the latest version from <a href="https://github.com/kassambara/survminer" target="_blank" rel="noopener">GitHub</a>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(!require(devtools)) install.packages("devtools")</span><br><span class="line">devtools::install_github("kassambara/survminer", build_vignettes = FALSE)</span><br></pre></td></tr></table></figure><p>Load survminer:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library("survminer")</span><br></pre></td></tr></table></figure><h3 id="其他R包相关操作："><a href="#其他R包相关操作：" class="headerlink" title="其他R包相关操作："></a>其他R包相关操作：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前镜像地址</span></span><br><span class="line">getOption(<span class="string">"repos"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看R_HOME地址</span></span><br><span class="line">R.home()</span><br><span class="line"></span><br><span class="line">R_HOME/doc/CRAN_mirrors.csv</span><br><span class="line">R_HOME/doc/BioC_mirrors.csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看R包安装位置</span></span><br><span class="line">.libPaths()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看已安装的包</span></span><br><span class="line">installed.packages()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看包版本</span></span><br><span class="line">packageVersion(<span class="string">"package_name"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新包</span></span><br><span class="line">update.packages(<span class="string">"package_name"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载包</span></span><br><span class="line">library(<span class="string">"package_name"</span>)</span><br><span class="line">require(<span class="string">"package_name"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看加载的包</span></span><br><span class="line">.packages()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除已加载的包（将包从R运行环境中移除）</span></span><br><span class="line">detach(<span class="string">"package_name"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 彻底删除已安装的包：</span></span><br><span class="line">remove.packages(<span class="string">"package_name"</span>, lib = file.path(<span class="string">"path/to/library"</span>))</span><br></pre></td></tr></table></figure><h3 id="自动安装包"><a href="#自动安装包" class="headerlink" title="自动安装包"></a>自动安装包</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">usePackage &lt;- <span class="keyword">function</span>(p) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!is.element(p, installed.packages()[,<span class="number">1</span>]))&#123;</span><br><span class="line">    options(repos=structure(c(CRAN=<span class="string">"https://mirrors.tuna.tsinghua.edu.cn/CRAN/"</span>)))</span><br><span class="line">    install.packages(p, dep = <span class="literal">TRUE</span>)</span><br><span class="line">    <span class="keyword">require</span>(p, character.only = <span class="literal">TRUE</span>)&#125;</span><br><span class="line">&#125;</span><br><span class="line">usePackage(<span class="string">"ggplot2"</span>)</span><br></pre></td></tr></table></figure><h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><ul><li><a href="https://www.jianshu.com/p/9e503a4e3563?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation" target="_blank" rel="noopener">https://www.jianshu.com/p/9e503a4e3563?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> R语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R </tag>
            
            <tag> installation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git基础代码</title>
      <link href="/post/git%E5%9F%BA%E7%A1%80/"/>
      <url>/post/git%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h3 id="Git基础"><a href="#Git基础" class="headerlink" title="Git基础"></a>Git基础</h3><h4 id="查看文件版本库中的文件状态："><a href="#查看文件版本库中的文件状态：" class="headerlink" title="查看文件版本库中的文件状态："></a>查看文件版本库中的文件状态：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><p>文件处于未修改状态</p><h4 id="修改文件，再次查看版本库中文件的状态"><a href="#修改文件，再次查看版本库中文件的状态" class="headerlink" title="修改文件，再次查看版本库中文件的状态"></a>修改文件，再次查看版本库中文件的状态</h4><p>对比文件修改前和修改后的变化：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff</span><br></pre></td></tr></table></figure><p>根据提示，我们能看到，文本的修改为添加了一行，即文字开头有加号的地方。如果删除一行，文字开头为减号。 </p><h4 id="提交修改内容与提交新文件"><a href="#提交修改内容与提交新文件" class="headerlink" title="提交修改内容与提交新文件"></a>提交修改内容与提交新文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add 文件名</span><br><span class="line">git commit -m "add a line"</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="再次查看"><a href="#再次查看" class="headerlink" title="再次查看"></a>再次查看</h4><p>提交后，再次查看版本库当前状态，会看到文件没有需要提交的更改。 </p><h4 id="撤销操作"><a href="#撤销操作" class="headerlink" title="撤销操作"></a>撤销操作</h4><p>有时提交完成后发现漏掉几个文件没有添加，或者信息写错了，这时候就需要对操作进行撤销。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## 例子</span></span></span><br><span class="line">git commit -m 'xxxxx'</span><br><span class="line">git add file</span><br><span class="line">git commit --amend</span><br></pre></td></tr></table></figure><ul><li>撤销对文件的修改 </li></ul><p>如果不想保留对某一个文件的修改，则可以使用<code>git checkout -- filename</code>来撤销对文件的修改。但是这个命令只是拷贝了另一个文件来覆盖它，文件的所有更改都将消失。</p><p>来源：<a href="https://blog.csdn.net/yidu_fanchen/article/details/78663359" target="_blank" rel="noopener">https://blog.csdn.net/yidu_fanchen/article/details/78663359</a></p><hr><h3 id="git-高级内容"><a href="#git-高级内容" class="headerlink" title="git 高级内容"></a>git 高级内容</h3><ul><li><a href="https://laozhu.me/post/git-submodule-tutorial/" target="_blank" rel="noopener">https://laozhu.me/post/git-submodule-tutorial/</a></li><li>阮一峰的博客 <a href="https://www.bookstack.cn/read/git-tutorial/README.md" target="_blank" rel="noopener">https://www.bookstack.cn/read/git-tutorial/README.md</a></li></ul><h4 id="从mac拷贝到windows10上"><a href="#从mac拷贝到windows10上" class="headerlink" title="从mac拷贝到windows10上"></a>从mac拷贝到windows10上</h4><p>进入目录后，需要执行以下命令，否则会出错：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email "your@example.com"</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>两种方法构建signatures（一）</title>
      <link href="/post/%E8%82%BF%E7%98%A4%20mutational%20signatures%E7%9A%84%E6%9E%84%E5%BB%BA/"/>
      <url>/post/%E8%82%BF%E7%98%A4%20mutational%20signatures%E7%9A%84%E6%9E%84%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>MutationalPatterns中进行因式分解用到了R包NMF。<br>确定因式分解的秩至关重要，要避免过度分解和分解不全的情况。<br>nmfEstimateRank函数帮助确定最佳的秩。</p><p>Function nmfEstimateRank helps in choosing an optimal rank by implementing simple approaches proposed in the literature.</p>]]></content>
      
      
      <categories>
          
          <category> Cancer genome </category>
          
          <category> Mutational Signatures </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mutational Signatures </tag>
            
            <tag> tumor </tag>
            
            <tag> NMF </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
